<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAC Widget Demo - Table with Input Fields</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: "72", "72full", Arial, Helvetica, sans-serif;
            background-color: #f5f5f5;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #0854a0;
            margin-bottom: 10px;
        }

        .description {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .widget-wrapper {
            min-height: 600px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 10px;
        }

        .controls {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }

        .controls h3 {
            margin-top: 0;
            color: #0854a0;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-label {
            display: inline-block;
            width: 150px;
            font-weight: 600;
        }

        button {
            padding: 8px 16px;
            background-color: #0854a0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }

        button:hover {
            background-color: #0a6ed1;
        }

        input[type="text"] {
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
        }

        .event-log {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
        }

        .event-log h3 {
            margin-top: 0;
            color: #0854a0;
        }

        .event-item {
            padding: 5px;
            margin: 5px 0;
            background-color: white;
            border-left: 3px solid #0854a0;
            padding-left: 10px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="demo-container">
        <h1>SAP Analytics Cloud Custom Widget Demo</h1>
        <p class="description">
            This is a demonstration of a custom SAC widget with an interactive table and input fields.
            You can add, edit, and delete rows, select rows, and export data. The widget follows SAP Fiori design
            guidelines.
        </p>

        <div class="widget-wrapper">
            <com-sap-sample-tablewidget id="myWidget"></com-sap-sample-tablewidget>
        </div>

        <div class="controls">
            <h3>Widget Controls (API Demo)</h3>

            <div class="control-group">
                <span class="control-label">Change Title:</span>
                <input type="text" id="titleInput" placeholder="Enter new title">
                <button onclick="changeTitle()">Set Title</button>
            </div>

            <div class="control-group">
                <button onclick="toggleInputFields()">Toggle Input Fields</button>
                <button onclick="addRowProgrammatically()">Add Row via API</button>
                <button onclick="simulateSacData()">Simulate SAC Data Source</button>
                <button onclick="getTableData()">Get Data (Console)</button>
                <button onclick="clearAllData()">Clear All Data</button>
            </div>
        </div>

        <div class="event-log">
            <h3>Event Log</h3>
            <div id="eventLog"></div>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        const widget = document.getElementById('myWidget');
        const eventLog = document.getElementById('eventLog');

        // Listen to widget events
        widget.addEventListener('onRowSelect', (e) => {
            logEvent('Row Selected', e.detail);
        });

        widget.addEventListener('onDataChange', (e) => {
            logEvent('Data Changed', e.detail);
        });

        function logEvent(eventName, detail) {
            const timestamp = new Date().toLocaleTimeString();
            const eventItem = document.createElement('div');
            eventItem.className = 'event-item';
            eventItem.textContent = `[${timestamp}] ${eventName}: ${JSON.stringify(detail)}`;
            eventLog.insertBefore(eventItem, eventLog.firstChild);

            // Keep only last 10 events
            while (eventLog.children.length > 10) {
                eventLog.removeChild(eventLog.lastChild);
            }
        }

        function changeTitle() {
            const newTitle = document.getElementById('titleInput').value;
            if (newTitle) {
                widget.title = newTitle;
                logEvent('Title Changed', { title: newTitle });
            }
        }

        let inputFieldsVisible = true;
        function toggleInputFields() {
            inputFieldsVisible = !inputFieldsVisible;
            widget.showInputFields = inputFieldsVisible;
            logEvent('Input Fields Toggled', { visible: inputFieldsVisible });
        }

        function addRowProgrammatically() {
            // This would require extending the widget to accept data programmatically
            alert('To add rows programmatically, you would need to extend the widget API to accept row data as a parameter.');
        }

        function simulateSacData() {
            const mockTableData = {
                data: [
                    { "dim1": { "description": "Global Sales" }, "dim2": { "description": "Finance" }, "meas1": { "rawValue": 150000 } },
                    { "dim1": { "description": "APAC Region" }, "dim2": { "description": "Sales" }, "meas1": { "rawValue": 85000 } },
                    { "dim1": { "description": "EMEA Operations" }, "dim2": { "description": "Operations" }, "meas1": { "rawValue": 120000 } }
                ],
                metadata: {
                    feeds: {
                        dimensions: { values: ["dim1", "dim2"] },
                        measures: { values: ["meas1"] }
                    }
                }
            };

            // Simulate the SAC property update
            widget.onCustomWidgetAfterUpdate({ "tableData": mockTableData });
            logEvent('SAC Data Simulated', { rows: 3 });
        }

        function getTableData() {
            const data = widget.getData();
            console.log('Current table data:', data);
            logEvent('Data Retrieved', { rowCount: data.length });
            alert(`Table has ${data.length} rows. Check console for details.`);
        }

        function clearAllData() {
            widget.clearTable();
        }

        // Initialize with some sample data
        window.addEventListener('load', () => {
            logEvent('Widget Loaded', { status: 'ready' });
        });
    </script>
</body>

</html>